<html> 
<style> 
#mainContainer {
  margin: 10px;
  padding: 10px;
  width: auto;
  border: 2px solid #ccc;
  -moz-border-radius: 6px;
  border-radius: 6px;
  }
table.inputItems {
  border-collapse: collapse;
  border-spacing: 0;
  }
 
table.inputItems td {
  font-size: 14px;
  border-bottom: 2px solid #fff;
  }
 
table.inputItems tr {
  background-color: #eee;;
  }
 
table.inputItems td.label {
  padding: 1px 5px;
  text-align: right;
  font-family: arial;
  clear: both;
  }
input.textleft {
  width: 150px;
  font-size: 12px;
  }
input.textright {
  width: 250px;
  font-size: 12px;
  }
input.sel {
  font-size: 12px;
  }
input.button {
  margin-left: 250px;
  }
textarea.hiddenta {
display: none;
}
div.lineno {
  float: left;
  font-size: 11px;
  font-family: arial;
  color: #444;
  }
div#time {
  float: left;
  margin-left: 65px;
  font-size: 11px;
  font-family: arial;
  color: #444;
  }
br {
 clear: both;
}
 
img#progresswheel {
position: absolute;
border: 0;
top: 300px;
left: 400px;
display: none;
}
</style> 
 
<link href="codeviewer/prettifyCode.css" type="text/css" rel="stylesheet" /> 
<script type="text/javascript" src="codeviewer/prettify.js"></script> 
<script type="text/javascript" src="codeviewer/prettifyMyEnhancements.js"></script> 
<script type="text/javascript" src="../js/library/ServerComm.js"></script> 
<script type="text/javascript" src="../js/library/JsonPClient.js"></script> 
<script type="text/javascript"> 
PrettyCode.splitString = "<br>";
</script> 
 
<body> 
<div id="mainContainer"> 
<form action="" onsubmit="return submitForm()" method="get">
<table class='inputItems' id="inputitems"> 
<tr><tr><td class='label'>script:</td><td><input class='textright' type='text'/></td></tr><tr></tr><td><input class='textleft' type='text' /></td><td><input class='textright' type='text'/></td></tr><tr><td><input class='textleft' type='text' /></td><td><input class='textright' type='text'/></td></tr><tr><td><input class='textleft' type='text' /></td><td><input class='textright' type='text'/></td></tr><tr><td><input class='textleft' type='text' /></td><td><input class='textright' type='text'/></td></tr><tr><td><input class='textleft' type='text' /></td><td><input class='textright' type='text'/></td></tr></table><input type="submit" value="test" class="button" />
</form>
<div class="lineno">hide line numbers: <input type="checkbox" id="linenocheckbox" onchange="PrettyCode.checkboxChanged()"/></div>
<br>
<div id="codediv"> 
</div>
 
</div> 
<script id="testscript"> 
var ssTest = function (inputData) {
  var _fileTools = require("../utils/FileTools");
    var t1 = new Date().getTime();
    if (inputData.dirname != null) {
      var dirCb = null;
      if (inputData.block) {
        var a = inputData.block.split(",");
        var block = {};
        for (var i=0; i<a.length; i++)
          block[a[i]] = true;
        dirCb = function (d) {
          return (block[d.name] === undefined);
        }
      }
      
      function makeDateTimeString (d) {
        var month = d.getMonth();
        var day	= d.getDate();
        var year = d.getYear();
        
        var hour = d.getHours();
        var minute = d.getMinutes();
        var ap = "am";
        
        if(hour > 11) {
          ap = "pm";
          if(hour	 > 12) 
            hour = hour - 12;
          }
        else if(hour == 0)
          hour = 12;			
        
        var dateStr = hour + ((minute < 10)?":0":":") + minute + ap;
        
        //if(month != this.thisMonth || day != this.today || year != this.thisYear)
          {
          dateStr += " " + (month+1) + "/" + day;
        
          if(year != this.thisYear) {
            year = (year%100);
            dateStr += ((year < 10)?"/0":"/") + year
            }
          }
        return dateStr;
        }

      var handlerCb = function (tree) {
        var t2 = new Date().getTime()
        // sort files and subdirs alphabetically
        _fileTools.sortFileTree(tree);

        var a = [];

        // function to convert dir and (optional) file into
        // string, and add it to array
        var addItemString = function (dir, file, isIter) {
          var path = _fileTools.getPath(dir, file,  ((isIter)?"blah":null));
          var s = path.join('/');
          if (file)
            s += " size: " + file.status.size + ", last modified: " + 
            
            makeDateTimeString(new Date(file.status.mtime));
          else
            s += " (" + dir.files.length + " files, " + dir.subDirs.length + " subdirs)";
          a.push(s);
        }

        // using iterator is good when we need it sequential,
        // but each file may spawn an an asynch action
        if (inputData.doIterator) {
          var getNext = _fileTools.getTreeIterator(tree);
          var item;
          var addNext = function () {
            var item = getNext();
            if (item) {
              addItemString(item[0], item[1], true);
              setTimeout(addNext, 100);
            }
            else {
              a.push(new Date().getTime() - t2, t2-t1);
              console.log(a);
            }
          };
          addNext();
        }
        // non-iterator is best when we know we want to do something
        // immediate per file
        else {
          _fileTools.walkFileTree(tree, function (dir, file) {
              addItemString(dir, file);
            });
          a.push(t2-t1, new Date().getTime() - t2);
          console.log(a);
        }
      };


      var maxDepth = ((inputData.maxdepth)?parseInt(inputData.maxdepth):null);
      // get the file tree as a nested data structure
      _fileTools.getFileTree(inputData.dirname, handlerCb, dirCb, maxDepth);
    }
    else console.log("no dir");
  }
</script>
<script> 
var currObj;

var showObj = function (o){
  /*document.getElementById("mainContainer").style.backgroundColor = "#" + 
    Math.floor(Math.random()*16).toString(16) + 
    Math.floor(Math.random()*16).toString(16) + 
    Math.floor(Math.random()*16).toString(16);
  */
  setTimeout(function() {
    if (typeof(o) == 'string')
      o = [o];
    currObj = o;
    var s = ServerComm.objectToJs (o, null, 100, true);
    PrettyCode.insertCode (s, null, {elemId: 'codediv'});
    }, 20);
  };

var submitForm = function () {
  var table = document.getElementById('inputitems');
  var a = table.getElementsByTagName ('input');
  var s = "/" + a[0].value + '?callback=showObj';
  for (var i=1; i<a.length; i+=2) {
    var n = a[i].value;
    var v = a[i+1].value;
    if (n && n!= '' && v && v != null) {
      s += '&' + escape(n) + "=" + escape(v);  
      }
    }
  var script = document.createElement("script");
  script.src = s + "&nocache=" + Math.round(Math.random()*10000);
  //alert(s);
  document.body.appendChild(script);
  return false;
  }

</script> 
</body> 
</html> 